<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="www.tonghao.service.common.mapper.ProtocolMapper">
    <resultMap id="BaseResultMap" type="www.tonghao.service.common.entity.Protocol">
        <!--
          WARNING - @mbg.generated
        -->
        <id column="id" jdbcType="BIGINT" property="id"/>
        <result column="name" jdbcType="VARCHAR" property="name"/>
        <result column="code" jdbcType="VARCHAR" property="code"/>
        <result column="start_time" jdbcType="VARCHAR" property="startTime"/>
        <result column="end_time" jdbcType="VARCHAR" property="endTime"/>
        <result column="created_at" jdbcType="VARCHAR" property="createdAt"/>
        <result column="updated_at" jdbcType="VARCHAR" property="updatedAt"/>
        <result column="is_delete" jdbcType="INTEGER" property="isDelete"/>
        <result column="status" jdbcType="INTEGER" property="status"/>
        <result column="platform_info_id" jdbcType="BIGINT" property="platformInfoId"/>
        <result column="platform_info_code" jdbcType="VARCHAR" property="platformInfoCode"/>
    </resultMap>

    <select id="selectByMap" resultMap="BaseResultMap">
        SELECT
            *
        FROM
            protocol
        WHERE
            is_delete = 0
            <if test="name != null and name != ''">
                AND name LIKE CONCAT('%',#{name},'%')
            </if>
            <if test="code != null and code != ''">
                AND code LIKE CONCAT('%',#{code},'%')
            </if>
            <if test="startTime != null and startTime != ''">
                AND start_time &gt;= #{startTime}
            </if>
            <if test="endTime != null and endTime != ''">
                AND end_time &lt;= #{endTime}
            </if>
            <if test="status != null and status == 1">
                AND now() &lt; start_time
            </if>
            <if test="status != null and status == 2">
                AND now() &gt;= start_time
                AND now() &lt;= end_time
            </if>
            <if test="status != null and status == 3">
                AND now() &gt;= end_time
            </if>
            <if test="status != null and status == 4">
                AND status = #{status}
            </if>
        ORDER BY id DESC
    </select>
</mapper>